<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>大樂透進階預測網站（JSON 版）</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(to bottom,#f0f4f7,#d9e2ec); text-align:center; padding:20px; }
h1 { margin-bottom:20px; color:#1f3c88; text-shadow:1px 1px 2px rgba(0,0,0,0.2); }
.card { background:#fff; border-radius:15px; padding:20px; margin:15px auto; box-shadow:0 5px 15px rgba(0,0,0,0.1); max-width:800px; }
button { border:none; border-radius:10px; padding:10px 15px; background:#1f3c88; color:white; font-weight:bold; cursor:pointer; transition:0.3s; }
button:hover { background:#3757d6; }
input, select { padding:8px 10px; border-radius:8px; border:1px solid #ccc; outline:none; transition:0.2s; }
input:focus, select:focus { border-color:#1f3c88; }
.number { display:inline-block; width:45px; height:45px; line-height:45px; border-radius:50%; margin:5px; font-size:18px; font-weight:bold; color:white; background:radial-gradient(circle at 30% 30%,#ffce00,#e6b800); box-shadow:0 3px 8px rgba(0,0,0,0.3); transition:0.2s; }
.number.special { background:radial-gradient(circle at 30% 30%,#ff7a7a,#e05555); box-shadow:0 3px 8px rgba(0,0,0,0.4); }
.stats { margin-top:30px; width:90%; max-width:900px; margin-left:auto; margin-right:auto; }
</style>
</head>
<body>
<h1>大樂透進階預測網站（JSON 版）</h1>

<div class="card">
  <h2>篩選與設定</h2>
  <div>
    <label>熱門閾值: <input type="number" id="hotThreshold" value="5" min="1" max="50"></label>
    <label>冷門閾值: <input type="number" id="coldThreshold" value="2" min="0" max="50"></label>
    <button onclick="drawChart()">更新圖表</button>
  </div>
  <div>
    <label>最近期數: <input type="number" id="recentCount" value="50" min="1" max="1000"></label>
    <button onclick="analyzeFrequency()">套用範圍分析</button>
  </div>
</div>

<div class="card">
  <h2>生成號碼</h2>
  <input type="number" id="groupCount" value="5" min="1" max="20"> 組建議號碼
  <select id="mode">
    <option value="random">隨機</option>
    <option value="hot">偏熱門號</option>
    <option value="cold">偏冷門號</option>
  </select>
  <button onclick="generateNumbers()">生成號碼</button>
</div>

<div class="card">
  <h2>冷熱號統計</h2>
  <canvas id="chart" class="stats" height="200"></canvas>
</div>

<div class="card" id="results">
  <h2>號碼結果</h2>
</div>

<script>
let lottoNumbers = [];
let freq = [];

window.onload = function() {
  fetch('lottoData.json')
    .then(response => response.json())
    .then(data => {
      // 將每期號碼取出
      lottoNumbers = data.map(item => item.numbers);
      analyzeFrequency();
    })
    .catch(err => console.error('讀取 JSON 失敗:', err));
}

function analyzeFrequency() {
  const recentCount = parseInt(document.getElementById('recentCount').value) || lottoNumbers.length;
  const numbersToAnalyze = lottoNumbers.slice(0, recentCount);
  freq = Array(49).fill(0);
  numbersToAnalyze.forEach(draw => {
    draw.forEach(n => { if(n>=1 && n<=49) freq[n-1]++; });
  });
  drawChart();
}

function drawChart() {
  const hotThreshold = parseInt(document.getElementById('hotThreshold').value) || 5;
  const coldThreshold = parseInt(document.getElementById('coldThreshold').value) || 2;
  const ctx = document.getElementById('chart').getContext('2d');
  if(window.myChart) window.myChart.destroy();
  window.myChart = new Chart(ctx, {
    type:'bar',
    data:{
      labels:Array.from({length:49},(_,i)=>i+1),
      datasets:[{
        label:'出現次數',
        data: freq,
        backgroundColor: freq.map(f=> f>=hotThreshold?'orange':(f<=coldThreshold?'skyblue':'lightgray'))
      }]
    },
    options:{ responsive:true, scales:{ y:{beginAtZero:true} } }
  });
}

function generateNumbers(){
  const resultsDiv = document.getElementById('results');
  resultsDiv.innerHTML='';
  const count = parseInt(document.getElementById('groupCount').value)||5;
  const mode = document.getElementById('mode').value;

  for(let g=0; g<count; g++){
    let mainNumbers=[], available=[];
    for(let i=1;i<=49;i++) available.push(i);

    for(let i=0;i<6;i++){
      let num;
      if(mode==='hot'){
        const sorted=available.sort((a,b)=>freq[b-1]-freq[a-1]);
        num=sorted[Math.floor(Math.random()*Math.min(10,sorted.length))];
      } else if(mode==='cold'){
        const sorted=available.sort((a,b)=>freq[a-1]-freq[b-1]);
        num=sorted[Math.floor(Math.random()*Math.min(10,sorted.length))];
      } else {
        num=available[Math.floor(Math.random()*available.length)];
      }
      mainNumbers.push(num);
      available=available.filter(n=>n!==num);
    }

    let special = available[Math.floor(Math.random()*available.length)];

    const groupDiv=document.createElement('div');
    mainNumbers.sort((a,b)=>a-b).forEach(n=>{
      const nDiv=document.createElement('div');
      nDiv.className='number';
      nDiv.textContent=n;
      groupDiv.appendChild(nDiv);
    });
    const sDiv=document.createElement('div');
    sDiv.className='number special';
    sDiv.textContent=special;
    groupDiv.appendChild(sDiv);
    resultsDiv.appendChild(groupDiv);
  }
}
</script>
</body>
</html>
